<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Transaction Reports</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="center-wrapper">
    <div class="report-box">

      <a class="back-link" href="{{ url_for('dashboard') }}">‚Üê Back to Dashboard</a>

      <h2 class="title">Transaction Reports</h2>
      <p class="subtitle">Filter and export transaction data</p>

      <!-- Filter Form -->
      <form method="POST" action="{{ url_for('transactions') }}">
        <div class="card-section">
          <h3>Date Range Filter</h3>
          <div class="flex-row">
            <div>
              <label for="start-date">Start Date</label>
              <input type="date" id="start-date" name="start_date" value="{{ start }}">
            </div>
            <div>
              <label for="end-date">End Date</label>
              <input type="date" id="end-date" name="end_date" value="{{ end }}">
            </div>
            <div>
              <button type="submit" class="filter-btn">üîç Filter</button>
            </div>
          </div>
        </div>
      </form>

      <!-- Export Button -->
      <form method="POST" action="{{ url_for('export_transactions') }}">
        <input type="hidden" name="start_date" value="{{ start }}">
        <input type="hidden" name="end_date" value="{{ end }}">
        <button type="submit" class="export-btn">‚¨áÔ∏è Export Excel</button>
      </form>

      <!-- Transactions Table -->
      <div class="card-section">
        <h3>Transactions</h3>
        {% if transactions %}
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Bank</th>
                <th>Receiver</th>
                <th>Phone</th>
                <th>Amount</th>
                <th>Transaction ID</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              {% for t in transactions %}
              <tr>
                <td>{{ t[0] }}</td>
                <td>{{ t[1] }}</td>
                <td>{{ t[2] }}</td>
                <td>{{ t[3] }}</td>
                <td>{{ t[4] }}</td>
                <td>{{ t[5] }}</td>
                <td>{{ t[6] }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>

          <!-- Pagination -->
          <div class="pagination">
            {% if start and end %}
              {% if page > 1 %}
                <a href="{{ url_for('transactions') }}?start_date={{ start }}&end_date={{ end }}&page={{ page - 1 }}">‚¨ÖÔ∏è Previous</a>
              {% endif %}
              <span>Page {{ page }}</span>
              {% if transactions|length == 10 %}
                <a href="{{ url_for('transactions') }}?start_date={{ start }}&end_date={{ end }}&page={{ page + 1 }}">Next ‚û°Ô∏è</a>
              {% endif %}
            {% endif %}
          </div>

        {% else %}
          <p class="subtitle">No transactions found for the selected date range.</p>
        {% endif %}
      </div>
    </div>
  </div>
</body>
</html>
